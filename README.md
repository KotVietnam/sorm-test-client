# Клиент для тестирования СОРМ

Этот скрипт (`traffic_generator.py`) предназначен для генерации различных видов сетевого трафика для тестирования систем СОРМ. Он эмулирует действия пользователя, такие как VoIP-звонки, отправка почты, обмен файлами, общение в мессенджерах и просмотр веб-сайтов.

## Системные требования

*   **Операционная система:** Windows 10/11
*   **Python:** Версия 3.8 или новее
*   **Права администратора:** Требуются для корректной работы `scapy` при отправке некоторых видов пакетов (например, RTP).

## Установка

Для работы скрипта необходимо установить несколько компонентов: Python, специальные драйверы для перехвата трафика, VoIP-клиент YATE и Python-библиотеки.

### 1. Установка Python

Если у вас не установлен Python, скачайте его с [официального сайта python.org](https://www.python.org/downloads/windows/).

**Важно:** Во время установки обязательно отметьте галочку **"Add Python to PATH"**.

### 2. Установка Npcap

Библиотека `scapy`, используемая для генерации низкоуровневого трафика, требует драйвер Npcap в Windows.

1.  Перейдите на [страницу загрузки Npcap](https://npcap.com/#download).
2.  Скачайте последнюю версию установщика.
3.  Во время установки **обязательно** выберите опцию **"Install Npcap in WinPcap API-compatible Mode"**.

![Npcap Installation](https://npcap.com/guide/images/installer-compat.png)

### 3. Установка YATE (для трафика H.323)

Для эмуляции звонков по протоколу H.323 используется консольный клиент YATE.

1.  Скачайте YATE с [официального сайта](https://yate.ro/download/). Вам потребуется Windows-версия.
2.  Установите программу в любую директорию (например, `C:\Program Files\YATE`).
3.  **Добавьте путь к исполняемым файлам YATE в системную переменную `PATH`:**
    *   Нажмите `Win + R`, введите `sysdm.cpl` и нажмите Enter.
    *   Перейдите на вкладку "Дополнительно" и нажмите "Переменные среды".
    *   В разделе "Системные переменные" найдите переменную `Path` и нажмите "Изменить".
    *   Нажмите "Создать" и добавьте путь к папке, где находится `yate-console.exe` (например, `C:\Program Files\YATE`).
    *   Сохраните изменения.

### 4. Установка Python-библиотек

1.  Склонируйте этот репозиторий на свой компьютер.
2.  Откройте **командную строку (cmd) или PowerShell от имени администратора**.
3.  Перейдите в директорию `sorm-test-client`:
    ```powershell
    cd path\to\sorm\sorm-test-client
    ```
4.  Установите все необходимые библиотеки с помощью команды:
    ```powershell
    pip install -r requirements.txt
    ```

## Настройка

Основная настройка клиента производится через файл `.env`.

1.  В папке `sorm-test-client` создайте файл с именем `.env`.
2.  Добавьте в него следующую строку:

    ```env
    # IP-адрес сервера, на котором запущен sorm-test-server
    DLP_SERVER_IP="XXX.XXX.XXX.XXX"
    ```

3.  Замените `XXX.XXX.XXX.XXX` на реальный "белый" IP-адрес вашего сервера.

## Использование

1.  Убедитесь, что сервер `sorm-test-server` запущен.
2.  Откройте **командную строку (cmd) или PowerShell от имени администратора**.
3.  Перейдите в директорию `sorm-test-client`.
4.  Запустите скрипт:

    ```powershell
    python traffic_generator.py
    ```

Скрипт начнет последовательно генерировать трафик для всех поддерживаемых протоколов. Для некоторых протоколов (WhatsApp, Telegram и т.д.) будут открываться вкладки в браузере.

### Параметры запуска

Вы можете управлять поведением скрипта с помощью аргументов командной строки.

*   `python traffic_generator.py [IP-адрес сервера]` - можно передать IP-адрес напрямую, без использования `.env` файла.
*   `--open-sites` - принудительно открывать сайты в браузере. По умолчанию скрипт делает это автоматически при запуске без других параметров.
*   `--timeout 10.0` - изменить таймаут ожидания ответа от сервера (в секундах).

Полный список параметров можно посмотреть, выполнив `python traffic_generator.py --help`.

## Поддерживаемые протоколы

Скрипт генерирует следующий трафик:
- **Веб-браузинг:** HTTP, HTTPS, RSS, а также открытие сайтов WhatsApp, Telegram, Instagram, Skype.
- **VoIP:** SIP (OPTIONS, REGISTER, полноценный звонок с RTP), H.323, IAX2, MGCP, Skinny.
- **Электронная почта:** SMTP (отправка письма с вложением), POP3, IMAP.
- **Мессенджеры:** XMPP (регистрация и отправка сообщения), IRC.
- **Передача файлов:** FTP (загрузка и скачивание файла).
- **Другое:** Telnet, RADIUS.